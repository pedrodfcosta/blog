<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>A Modern Take on Cutting the Mustard | Snugug</title><link rel="icon" href="/images/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="google-site-verification" content="zIeV2B7zZKCtEFP-6vV8rKk0ocpbp035v_g3IRn12Jo"><script src="/js/main.js" defer="defer"></script><style type="text/css">article,body,div,h1,header,html,main{background:0 0;border:0;font-size:100%;margin:0;outline:0;padding:0;vertical-align:baseline}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{line-height:1}article,header,main{display:block}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}:root{font-size:125%;font-family:aller,'Lucida Grande','Lucida Sans Unicode','Lucida Sans',Geneva,Verdana,sans-serif}body{background:#f8f7f2;color:#2c2a21;text-rendering:optimizeLegibility;-webkit-font-feature-settings:"liga","dlig";-ms-font-feature-settings:"liga","dlig";-o-font-feature-settings:"liga","dlig";font-feature-settings:"liga","dlig";font-weight:400}body *+*{margin-top:1rem}.article--heading{width:100vw;padding:2rem;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;z-index:-1}.article--heading{background-color:#c20030;background:linear-gradient(0deg,rgba(194,0,48,0) 10%,rgba(194,0,48,.05) 10%,rgba(194,0,48,.05) 20%,rgba(194,0,48,.1) 20%,rgba(194,0,48,.1) 30%,rgba(194,0,48,.15) 30%,rgba(194,0,48,.15) 40%,rgba(194,0,48,.2) 40%,rgba(194,0,48,.2) 50%,rgba(194,0,48,.3) 50%,rgba(194,0,48,.3) 60%,rgba(194,0,48,.4) 60%,rgba(194,0,48,.4) 70%,rgba(194,0,48,.5) 70%,rgba(194,0,48,.5) 80%,rgba(194,0,48,.6) 80%,rgba(194,0,48,.6) 90%,rgba(194,0,48,.8) 90%),linear-gradient(-90deg,rgba(194,0,48,0) 10%,rgba(194,0,48,.05) 10%,rgba(194,0,48,.05) 20%,rgba(194,0,48,.1) 20%,rgba(194,0,48,.1) 30%,rgba(194,0,48,.15) 30%,rgba(194,0,48,.15) 40%,rgba(194,0,48,.2) 40%,rgba(194,0,48,.2) 50%,rgba(194,0,48,.3) 50%,rgba(194,0,48,.3) 60%,rgba(194,0,48,.4) 60%,rgba(194,0,48,.4) 70%,rgba(194,0,48,.5) 70%,rgba(194,0,48,.5) 80%,rgba(194,0,48,.6) 80%,rgba(194,0,48,.6) 90%,rgba(194,0,48,.8) 90%),#da9400;min-height:100vh}.article--title{text-shadow:0 -.005em #111,-.005em 0 #282727,-.005em -.01em #111,-.01em -.005em #282727,-.01em -.015em #111,-.015em -.01em #282727,-.015em -.02em #111,-.02em -.015em #282727,-.02em -.025em #111,-.025em -.02em #282727,-.025em -.03em #111,-.03em -.025em #282727,-.03em -.035em #111,-.035em -.03em #282727,-.035em -.04em #111,-.04em -.035em #282727,-.04em -.045em #111,-.045em -.04em #282727,-.045em -.05em #111,-.05em -.045em #282727,-.05em -.055em #111,-.055em -.05em #282727,-.055em -.06em #111,-.06em -.055em #282727,-.06em -.065em #111,-.065em -.06em #282727,-.065em -.07em #111,-.07em -.065em #282727,-.07em -.075em #111,-.075em -.07em #282727;-webkit-font-feature-settings:"liga","dlig";-ms-font-feature-settings:"liga","dlig";-o-font-feature-settings:"liga","dlig";font-feature-settings:"liga","dlig";color:#f8f7f2;font-size:2rem;font-weight:700;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;line-height:1.2;margin-right:0;margin:0 auto;max-width:100%;text-align:right;text-rendering:optimizeLegibility;word-wrap:break-word}@media (min-width:860px){.article--title{font-size:6vw;margin-right:calc(10% - 2rem);max-width:80%}}._blog{margin-top:0}@supports (display:flex){._blog{display:-ms-flexbox;display:flex;min-height:100vh;-ms-flex-direction:column;flex-direction:column}}@supports (display:flex){._blog--article{-ms-flex:1;flex:1}}</style><link rel="preload" href="/css/style.css" as="style" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/css/style.css"></noscript><script>!function(u){"use strict";var e=function(e,t,n){var r,o=u.document,a=o.createElement("link");if(t)r=t;else{var l=(o.body||o.getElementsByTagName("head")[0]).childNodes;r=l[l.length-1]}var i=o.styleSheets;a.rel="stylesheet",a.href=e,a.media="only x",function e(t){if(o.body)return t();setTimeout(function(){e(t)})}(function(){r.parentNode.insertBefore(a,t?r:r.nextSibling)});var d=function(e){for(var t=a.href,n=i.length;n--;)if(i[n].href===t)return e();setTimeout(function(){d(e)})};function s(){a.addEventListener&&a.removeEventListener("load",s),a.media=n||"all"}return a.addEventListener&&a.addEventListener("load",s),(a.onloadcssdefined=d)(s),a};"undefined"!=typeof exports?exports.loadCSS=e:u.loadCSS=e}("undefined"!=typeof global?global:this),function(r){if(r.loadCSS){var e=loadCSS.relpreload={};if(e.support=function(){try{return r.document.createElement("link").relList.supports("preload")}catch(e){return!1}},e.poly=function(){for(var e=r.document.getElementsByTagName("link"),t=0;t<e.length;t++){var n=e[t];"preload"===n.rel&&"style"===n.getAttribute("as")&&(r.loadCSS(n.href,n,n.getAttribute("media")),n.rel=null)}},!e.support()){e.poly();var t=r.setInterval(e.poly,300);r.addEventListener&&r.addEventListener("load",function(){e.poly(),r.clearInterval(t)}),r.attachEvent&&r.attachEvent("onload",function(){r.clearInterval(t)})}}}(this);</script><script id="font-load">(function () {
      'use strict';

      var fontURL = '/css/fonts.css?bust=342918',
          fonts,
          req,
          style,
          fontUrlLS;

      window.domCL = false;

      window.addEventListener('DOMContentLoaded', function () {
        window.domCL = true;
      });

      if (window.localStorage && document.querySelector && window.XMLHttpRequest) {
        fonts = localStorage.getItem('fonts');
        fontUrlLS = localStorage.getItem('fontURL');

        if (fonts && fontUrlLS === fontURL) {
          req = document.querySelector('#font-load');

          style = window.document.createElement('style');
          style.innerHTML = fonts;

          req.parentNode.insertBefore(style, req.nextSibling);
        }
        else {
          window.addEventListener('load', function () {
            req = new XMLHttpRequest();
            req.open('GET', fontURL);
            req.onreadystatechange = function () {
              localStorage.setItem('fonts', req.responseText);
              localStorage.setItem('fontURL', fontURL);
            }
            req.send();
          });
        }
      }
    })();</script></head><body><div class="_blog"><main class="_blog--article" itemscope="" itemtype="http://schema.org/Blog"><article class="article"><header class="article--heading"><h1 class="article--title" itemprop="name">A Modern Take on Cutting the Mustard</h1></header><div class="article--content base" itemprop="text"><p>One of the easiest ways to <a href="https://alistapart.com/article/understandingprogressiveenhancement">progressively enhance</a> your web experience is the <a href="http://responsivenews.co.uk/post/18948466399/cutting-the-mustard">Cutting the Mustard</a> technique. The essence of Cutting the Mustard is:</p><ol><li>Provide an accessible base-line experience for everyone using semantic HTML and CSS</li><li>Write a test for a minimum subset of JavaScript functionality to support.<ul><li>If the test <em>passes</em>, enhance the experience with modern JavaScript</li><li>If the test <em>fails</em>, enhance enhance the experience with older JavaScript (and usually a subset of the modern JavaScript's functionality)</li></ul></li></ol><p>The original test was developed by the BBC team to distinguish between HTML5 browsers and non-HTML5 browsers. That test was fairly straight forward:</p><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'querySelector'</span> <span class="token keyword">in</span> document
  <span class="token operator">&amp;&amp;</span> <span class="token string">'localStorage'</span> <span class="token keyword">in</span> window
  <span class="token operator">&amp;&amp;</span> <span class="token string">'addEventListener'</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Enhance for HTML5 browsers</span>
<span class="token punctuation">}</span>
</code></pre><p>This works really well! The enhancements being looked for are all functions that hang off of <code>document</code> or <code>window</code> and can looked for using checks, so we use these tests even in browsers that don't support that functionality! Our progressive enhancement life is wonderful!</p><h2>Enter ES2015+</h2><p>Starting with ES2015, or ES6, new JavaScript functionality started to be added that couldn't be tested for by checking if a property exists; it introduced some actual new JavaScript syntax, like <code>const</code>, <code>let</code>, arrow functions, and classes. The problem we now face wanting to test for support of these new syntaxes is that we can't even <em>write</em> the new syntax and deliver it to browsers that don't support it without errors! This is because, unlike HTML and CSS which can gracefully ignore unsupported syntax, JavaScript can't! How, then, can we Cut the Mustard in a way that won't cause errors in unsupported browsers without compiling or transpiling our modern JavaScript syntax?</p><p><strong>JavaScript Modules to the Rescue</strong></p><h2>Using Modules to Cut the Mustard</h2><p>Let's get straight to the code, then we'll explain it:</p><pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./mustard.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nomodule</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./no-mustard.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- Can be done inline too --></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> mustard <span class="token keyword">from</span> <span class="token string">'./mustard.js'</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nomodule</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'No Mustard!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre><p>When JavaScript modules were introduced, two new bits of HTML syntax were introduced that make this all possible: <code>type=&quot;module&quot;</code> for <code>&lt;script&gt;</code> tags, and the <code>nomodule</code> attribute.</p><p>In all browsers that <a href="https://caniuse.com/#feat=es6-module">support JavaScript module via <code>script</code> tags</a>, <code>&lt;script type=&quot;module&quot;&gt;</code> will be interpreted as a JavaScript module and loaded and run as expected, but for browsers that don't recognize that type, it'll just be ignored because it's unknown HTML syntax! Easy Peasy! Mustard, cut.</p><p>We can also &quot;test&quot; for the opposite by including the <code>nomodule</code> attribute. In all browsers that support <code>type=&quot;module&quot;</code> (except Safari 10.1 and iOS Safari 10.3), adding the <code>nomodule</code> attribute to out <code>&lt;script&gt;</code> tags will have that JavaScdipt ignored in module-supporting browsers while it'll load and run as expected in all other browsers! While it's not <em>absolutely perfect</em> coverage (less than 1% of browsers globally will fall in to this category at the time of this writing), it's likely good enough for most production work.</p><h2>What's Our New Baseline</h2><p>Using JavaScript modules as our new baseline gives us a <a href="https://caniuse.com/#compare=edge+16,firefox+60,chrome+61,safari+10.1,opera+48,ios_saf+10.3,and_chr+67,and_ff+60">great modern baseline</a> of HTML, CSS, and JavaScript functionality that we can just <em>know</em> is available to us. Some JavaScript highlights from this list are:</p><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const"><code>const</code></a> and partial <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let"><code>let</code></a> support</li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promises</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">async functions</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API"><code>fetch</code></a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">Arrow functions</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters">Rest parameters</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes">Classes</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">Template Literals</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator">Generators</a></li><li>And, of course, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">JavaScript Modules</a></li></ul><p>That's quite a bit of new syntax we get <em>out of the box</em> by setting our baseline to JavaScript modules. This is, of course, in addition to everything we can test for and use that's <em>not</em> based on new syntax, like Service Workers and Intersection Observers. We can even do it on a feature-by-feature basis:</p><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'IntersectionObserver'</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Intersection Observers, GO!</span>
<span class="token punctuation">}</span>
</code></pre><p>With the power of JavaScript modules as a modern Cutting the Mustard technique, we have a modern JavaScript baseline we can code to. Combined with our tried-and-true progressive enhancement feature testing, it may finally be time to put down our compilers and transpilers and start delivering cutting-edge JavaScript straight from editor to browser.</p></div><footer class="article--author"><span class="article--published" itemprop="datePublished">Published on <time datetime="2018-07-29">July 29th, 2018</time></span></footer></article></main><footer class="_blog--footer"><div class="footer"><ul class="footer--links"><li class="footer--link-item"><a href="/" class="footer--link">Home</a></li><li class="footer--link-item"><a href="/me/" class="footer--link">Me</a></li><li class="footer--link-item"><a href="/presentations/" class="footer--link">Presentations</a></li><li class="footer--link-item"><a href="/musings/" class="footer--link">Musings</a></li></ul></div></footer></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-30577396-1', 'auto');
    ga('send', 'pageview');</script></body></html>